<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Crossplane is a framework for building cloud native control planes without needing to write code. It has a highly extensible backend that enables you to build a control plane that can orchestrate applications and infrastructure no matter where they run, and a highly configurable frontend that puts you in control of the schema of the declarative API it offers."><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=robots content="noindex"><title>xpkg Specification| Crossplane Documentation</title><meta name=twitter:card content="summary"><meta name=twitter:site content="https://crossplane.io"><meta name=twitter:title content="Crossplane"><meta name=twitter:description content="The cloud-native control plane framework"><meta name=twitter:image:src content="https://crossplane.io/images/twitter-card_400x400.jpg"><link rel=apple-touch-icon sizes=180x180 href="/favicons/apple-touch-icon.png?v=1.0"><link rel=icon type=image/png sizes=32x32 href="/favicons/favicon-32x32.png?v=1.0"><link rel=icon type=image/png sizes=16x16 href="/favicons/favicon-16x16.png?v=1.0"><link rel=manifest href="/favicons/site.webmanifest?v=1.0"><link rel=mask-icon href="/favicons/safari-pinned-tab.svg?v=1.0" color=#5bbad5><link rel="shortcut icon" href="/favicons/favicon.ico?v=1.0"><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css><link rel=stylesheet href=/css/docs.css><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js></script></head><body><div id=header><div><div class=logo><a href=/><img src=/images/logo.svg alt="Crossplane Logo"></a></div><div class=hamburger-controls onclick='return document.body.classList.contains("menu-open")?document.body.classList.remove("menu-open"):document.body.classList.add("menu-open"),!1'><span></span>
<span></span>
<span></span></div><ul class=links><li><a href=https://github.com/crossplane/crossplane><span class=md-hidden>Get Started on</span> GitHub</a></li><li><a href=/v1.9/>Documentation</a></li><li><a href=/community/>Community</a></li><li><a href=https://slack.crossplane.io/>Slack <span class=md-hidden>Channel</span></a></li><li><a href=https://blog.crossplane.io/>Blog</a></li><li><a href=https://twitter.com/crossplane_io>Twitter</a></li></ul></div></div><div id=docs-header><div><h1>Documentation</h1><div class=versions><div><div><select onchange="window.location.href=this.value"><option selected value=/master/reference/xpkg/>Crossplane master</option><option value=/v1.9/reference/xpkg/>Crossplane v1.9</option><option selected value=/v1.8/reference/xpkg/>Crossplane v1.8</option><option value=/v1.7/reference/xpkg/>Crossplane v1.7</option></select></div></div></div></div></div><div class=page><div class=docs-menu><ul id=docs-ul></ul></div><div class=docs-content><div class=docs-actions><a id=edit href=https://github.com/crossplane/crossplane/tree/release-1.8/docs/xpkg.md><img src=/images/github-teal.svg>Edit on GitHub</a></div><div class="alert old"><p><b>PLEASE NOTE</b>: This document applies to version 1.8 and not to the latest release 1.9</p><strong>Documentation for other releases can be found by using the version selector in the top right of any doc page.</strong></div><h1>xpkg Specification</h1><h1 id=overview>Overview</h1><p>Crossplane supports two types of <a href=/v1.8/concepts/packages/>packages</a>: Providers and Configurations. These
packages are distributed as generic <a href=https://github.com/opencontainers/image-spec>OCI images</a>, which contain <a href=https://yaml.org/spec/1.2.2/>YAML</a> content
informing the Crossplane package manager how to alter the state of a cluster by
installing objects that configure new resource types, and starting controllers
to reconcile them. An OCI image that contains valid Crossplane package content
is commonly referred to as an <code>xpkg</code> (&ldquo;ex-package&rdquo;). This document provides the
specification for a valid <code>xpkg</code>, which can be considered a superset of the
requirements detailed in the <a href=https://github.com/opencontainers/image-spec/blob/main/spec.md>OCI image specification</a>. It is divided into two
broad sections: requirements related to OCI image format and requirements
related to Crossplane <code>package.yaml</code> contents.</p><ul><li><a href=#oci-image-format>OCI Image Format</a><ul><li><a href=#indexes>Indexes</a></li><li><a href=#manifests>Manifests</a></li><li><a href=#configuration>Configuration</a></li><li><a href=#layers>Layers</a></li></ul></li><li><a href=#packageyaml-contents>package.yaml Contents</a><ul><li><a href=#configuration-package-requirements>Configuration Package Requirements</a></li><li><a href=#provider-package-requirements>Provider Package Requirements</a></li><li><a href=#object-annotations>Object Annotations</a></li></ul></li></ul><h2 id=oci-image-format>OCI Image Format</h2><p>OCI images are comprised of <a href=https://github.com/opencontainers/image-spec/blob/main/manifest.md>manifests</a>, <a href=https://github.com/opencontainers/image-spec/blob/main/config.md>configuration</a>, and <a href=https://github.com/opencontainers/image-spec/blob/main/layer.md>layers</a>.
Additionally, an image reference could refer to an image <a href=https://github.com/opencontainers/image-spec/blob/main/image-index.md>index</a>, which may
reference multiple image manifests and is frequently used for multi-platform
images. A valid Crossplane <code>xpkg</code> imposes various requirements on the components
of an OCI, each of which are described in the following sections.</p><h3 id=indexes>Indexes</h3><p>The components of an <code>xpkg</code> that Crossplane interacts with do not contain any
platform-specific information, so Crossplane is broadly agnostic to the
formatting of an image index. Crossplane does impose the following requirements
on an image index:</p><ul><li>At least one (1) manifest MUST be referenced in the manifest descriptor array
for a package to be successfully fetched and processed.</li></ul><blockquote><p>The OCI image specification allows for zero-length manifest descriptor arrays
in an index.</p></blockquote><p>The following default behavior when interacting with image indexes is
implemented in the Crossplane package manager:</p><ul><li>If one manifest is referenced in the image index, the image it points to will
be used.</li><li>If multiple manifests are referenced in the image index, Crossplane will use
the <code>linux/amd64</code> variant by default.</li></ul><blockquote><p>It is important to note that the platform of the package image that is used by
Crossplane does not necessarily mean that the same platform will be used for
the controller if the package is a Provider. The decision of selecting a
platform for a Provider controller image is deferred to the configured
container runtime.</p></blockquote><h3 id=manifests>Manifests</h3><p>A manifest defines the layers and configuration of a specific image. Crossplane
is only concerned with the layer descriptors array in an image manifest and does
not impose additional requirements on any other portions of the manifest. The
following requirements are imposed on the layer descriptors array:</p><ul><li>One (1) layer descriptor in the array MAY have an <a href=https://github.com/opencontainers/image-spec/blob/main/annotations.md>annotation</a> with key
<code>io.crossplane.xpkg</code> and value <code>base</code>.</li><li>Any number of layer descriptors in the array MAY have an annotation with key
<code>io.crossplane.xpkg</code> and arbitrary value. Whether multiple layer descriptors
may have the same value is left to the specification of the consumer of those
layers.</li></ul><blockquote><p>As evidenced by the fact that annotations are provided as a map of
<em>string-string</em>, no single descriptor will contain multiple
<code>io.crossplane.xpkg</code> annotations.</p></blockquote><p>Crossplane is only concerned with the layer with the <code>base</code> annotation, and any
other layers with the <code>io.crossplane.xpkg</code> key are used to signify to
third-party consumers that a layer contains content related to the <code>xpkg</code> that
may be specific to a given consumer.</p><p>If no layer descriptors have an annotation in the form <code>io.crossplane.xpkg: base</code>, the resultant filesystem from <a href=https://github.com/opencontainers/image-spec/blob/main/layer.md#applying-changesets>applying changesets</a> from all layers will
be used. It is preferred to use layer descriptor annotations.</p><p><strong>Motivation</strong></p><p>Crossplane prefers the usage of annotated layer descriptors because it allows
for fetching and processing individual layers, rather than all layers in the
image. In the event that the image contains a single layer, this overhead is
minimal. However, larger images with many layers, whether they contain
third-party <code>xpkg</code> content or unrelated data, will result in multiple network
calls and more data to process.</p><p>Crossplane also prefers the usage of annotated layer descriptors to define
additive package content (i.e. third-party <code>xpkg</code> content) as it provides a
clean mechanism to build an <code>xpkg</code> through a series of stages. A valid <code>xpkg</code>
can be produced and later modified while verifying that the integrity of the
existing content is not violated, which ensures that Crossplane&rsquo;s package
manager will process the resulting <code>xpkg</code> in the same manner as the it would
prior to modification.</p><p>While not explicitly forbidden, modifying content from a preceding layer with
the <code>io.crossplane.xpkg</code> annotation in any subsequent layers is discouraged, as
it may lead to confusion if a third-party is consuming content from the
flattened filesystem.</p><h3 id=configuration>Configuration</h3><p>Crossplane imposes no additional requirements on image configuration and does
not consider its contents when processing a package.</p><h3 id=layers>Layers</h3><p>As described above, Crossplane is only concerned with the single layer
referenced by the descriptor containing <code>io.crossplane.xpkg: base</code> if
distinguished. Crossplane imposes no additional restrictions on any other
layers, including those with a <code>io.crossplane.xpkg</code> annotation but a value other
than <code>base</code>, but does require the following of the <code>xpkg</code> base layer:</p><ul><li>A single file with name <code>package.yaml</code> MUST exist in the root directory of the
<code>xpkg</code> base layer if distinguished, or in the root of the image filesystem
after all layer changesets are applied.</li><li>The <code>package.yaml</code> file MUST contain a valid <a href=https://yaml.org/spec/1.2.2/#92-streams>YAML stream</a>.</li><li>All other content in either the <code>xpkg</code> base layer, or the full image
filesystem is ignored by Crossplane.</li></ul><blockquote><p>The ability to use the image&rsquo;s flattened filesystem is primarily for backwards
compatibility and is not encouraged, especially in the event that an image
contains more than just <code>xpkg</code> related content, due to the fact that
accidentally overwriting or modifying the <code>xpkg</code> layer contents in subsequent
layers when constructing an image could cause the package to be invalid.</p></blockquote><h2 id=packageyaml-contents>package.yaml Contents</h2><p>Depending on the type of package, the YAML stream in the <code>xpkg</code> base layer
<code>package.yaml</code> may contain different content. Additionally, the objects in the
YAML stream may contain common annotations that are suitable for the given
object type.</p><h3 id=configuration-package-requirements>Configuration Package Requirements</h3><p>The <code>package.yaml</code> for Configuration packages must adhere to the following
requirements:</p><ul><li>One (1) and only one <code>Configuration.meta.pkg.crossplane.io</code> object MUST be
defined in the YAML stream.</li><li>Zero (0) or more <code>CompositeResourceDefinition.apiextensions.crossplane.io</code>
objects MAY be defined in the YAML stream.</li><li>Zero (0) or more <code>Composition.apiextensions.crossplane.io</code> objects MAY be
defined in the YAML stream.</li><li>Zero (0) other object types may be defined in the YAML stream.</li></ul><h3 id=provider-package-requirements>Provider Package Requirements</h3><p>The <code>package.yaml</code> for Provider packages must adhere to the following
requirements:</p><ul><li>One (1) and only one <code>Provider.meta.pkg.crossplane.io</code> object MUST be defined
in the YAML stream.</li><li>Zero (0) or more <code>CustomResourceDefinition.apiextensions.k8s.io</code> objects MAY
be defined in the YAML stream.</li><li>Zero (0) or more <code>AdmissionWebhookConfiguration.admissionregistration.k8s.io</code>
objects MAY be defined in the YAML stream.</li><li>Zero (0) or more <code>MutatingWebhookConfiguration.admissionregistration.k8s.io</code>
objects MAY be defined in the YAML stream.</li><li>Zero (0) other object types may be defined in the YAML stream.</li></ul><h3 id=object-annotations>Object Annotations</h3><p>Though not used directly by Crossplane, the following object metadata
annotations (not to be confused with descriptor annotations in an OCI image
manifest) are defined for <code>Configuration.meta.pkg.crossplane.io</code> and
<code>Provider.meta.pkg.crossplane.io</code> and should be honored over any competing
annotations by third-party consumers of Crossplane packages:</p><ul><li><code>meta.crossplane.io/maintainer</code>: The package&rsquo;s maintainers, as a short opaque
text string.</li><li><code>meta.crossplane.io/source</code>: The URL at which the package&rsquo;s source can be
found.</li><li><code>meta.crossplane.io/license</code>: The license under which the package&rsquo;s source is
released. This should be a valid <a href=https://spdx.org/licenses/>SPDX License Identifier</a>.</li><li><code>meta.crossplane.io/description</code>: A one sentence description of the package.</li><li><code>meta.crossplane.io/readme</code>: A longer description, documentation, etc.</li></ul><p>Third party consumers may define additional arbitrary annotations with any key
and value on any object in a package. All annotations on &ldquo;meta&rdquo; types (i.e.
<code>Configuration.meta.pkg.crossplane.io</code> and <code>Provider.meta.pkg.crossplane.io</code>)
are propagated to the respective package revision (i.e.
<code>ConfigurationRevision.pkg.crossplane.io</code> and
<code>ProviderRevision.pkg.crossplane.io</code>) on package install. Annotations on all
other objects in a package are propagated to their in-cluster representation
unmodified.</p></div></div><script>var i,j,menu=[],menuDom,item,itemDom,children;menu.push({childCurrent:!1,children:[{current:!1,name:"Install \u0026 Configure",url:"/v1.8/getting-started/install-configure/"},{current:!1,name:"Provision Infrastructure",url:"/v1.8/getting-started/provision-infrastructure/"},{current:!1,name:"Create a Configuration",url:"/v1.8/getting-started/create-configuration/"}],current:!1,name:"Overview",url:"/v1.8/getting-started/"}),menu.push({childCurrent:!1,children:[{current:!1,name:"Providers",url:"/v1.8/concepts/providers/"},{current:!1,name:"Managed Resources",url:"/v1.8/concepts/managed-resources/"},{current:!1,name:"Composite Resources",url:"/v1.8/concepts/composition/"},{current:!1,name:"Crossplane Packages",url:"/v1.8/concepts/packages/"},{current:!1,name:"Terminology",url:"/v1.8/concepts/terminology/"}],current:!1,name:"Concepts",url:"/v1.8/concepts/"}),menu.push({childCurrent:!1,children:[{current:!1,name:"Upgrading to v0.14",url:"/v1.8/guides/upgrading-to-v0.14/"},{current:!1,name:"Upgrading to v1.x",url:"/v1.8/guides/upgrading-to-v1.x/"},{current:!1,name:"Vault as an External Secret Store",url:"/v1.8/guides/vault-as-secret-store/"},{current:!1,name:"Vault Credential Injection",url:"/v1.8/guides/vault-injection/"},{current:!1,name:"Multi-Tenant Crossplane",url:"/v1.8/guides/multi-tenant/"},{current:!1,name:"Composition Revisions",url:"/v1.8/guides/composition-revisions/"},{current:!1,name:"Self-Signed CA Certs",url:"/v1.8/guides/self-signed-ca-certs/"}],current:!1,name:"Guides",url:"/v1.8/guides/"}),menu.push({childCurrent:!1,children:[{current:!1,name:"crossplane",url:"/v1.8/api-docs/crossplane/"},{current:!1,name:"provider-alibaba",url:"/v1.8/api-docs/provider-alibaba/"},{current:!1,name:"provider-aws",url:"/v1.8/api-docs/provider-aws/"},{current:!1,name:"provider-azure",url:"/v1.8/api-docs/provider-azure/"},{current:!1,name:"provider-gcp",url:"/v1.8/api-docs/provider-gcp/"},{current:!1,name:"provider-rook",url:"/v1.8/api-docs/provider-rook/"},{current:!1,name:"provider-helm",url:"/v1.8/api-docs/provider-helm/"}],current:!1,name:"API Documentation",url:"/v1.8/api-docs/"}),menu.push({childCurrent:!1,children:[{current:!1,name:"Provider Development Guide",url:"/v1.8/contributing/provider_development_guide/"},{current:!1,name:"Observability Developer Guide",url:"/v1.8/contributing/observability_developer_guide/"},{current:!1,name:"Release Process",url:"/v1.8/contributing/release-process/"},{current:!1,name:"Adding Secret Store Support",url:"/v1.8/contributing/adding_external_secret_store_support/"}],current:!1,name:"Contributing",url:"/v1.8/contributing/"}),menu.push({childCurrent:!1,children:[{current:!1,name:"Related Projects",url:"/v1.8/faqs/related_projects/"}],current:!1,name:"FAQ",url:"/v1.8/faqs/"});function getEntry(e){var t=document.createElement("li");return e.current?(t.innerHTML=e.name,t.classList.add("current")):t.innerHTML='<a href="'+e.url+'">'+e.name+"</a>",t}function flushCss(e){e.offsetHeight}function addArrow(e){var t=document.createElement("a");t.classList.add("arrow"),t.innerHTML="<div />",t.onclick=function(e){return function(){var n=59,s=16,t=n+s+e.lastChild.clientHeight+"px";return e.classList.toggle("open"),e.classList.contains("open")?e.style.height=t:(e.style.height==="auto"&&(e.style.transition="none",e.style.height=t,flushCss(e),e.style.transition=""),e.style.height="59px"),!1}}(e),e.appendChild(t),item.current&&item.children||item.childCurrent?(e.classList.add("open"),e.style.height="auto"):e.style.height="59px"}menuDom=document.getElementById("docs-ul");for(i=0;i<menu.length;i++){if(item=menu[i],itemDom=getEntry(item),item.childCurrent&&itemDom.classList.add("childCurrent"),item.children){addArrow(itemDom),itemDom.classList.add("children"),children=document.createElement("ul");for(j=0;j<item.children.length;j++)children.appendChild(getEntry(item.children[j]));itemDom.appendChild(children)}menuDom.appendChild(itemDom)}</script><script src=/js/anchor.js></script>
<script>anchors.options={placement:"right",icon:"#"},document.addEventListener("DOMContentLoaded",function(){anchors.add(".docs-content h1, .docs-content h2, .docs-content h3, .docs-content h4, .docs-content h5, .docs-content h6")})</script><div id=footer><div class=footer-main><div class=main><div class=logo><img src=/images/logo.svg alt="Crossplane Logo"></div></div><div class="links sm-hidden"><a href=https://twitter.com/crossplane_io>Twitter</a>
<a href=/v1.9/>Documentation</a>
<a href=https://github.com/crossplane/crossplane>GitHub</a>
<a href=https://slack.crossplane.io/>Slack Channel</a>
<a href=https://www.youtube.com/channel/UC19FgzMBMqBro361HbE46Fw>YouTube</a>
<a href=https://groups.google.com/forum/#!forum/crossplane-dev>Forum</a></div></div><div class=lf-copyright><p>&#169; Crossplane Authors 2022. Documentation distributed under
<a href=https://creativecommons.org/licenses/by/4.0/>CC-BY-4.0</a>.</p><p>&#169; 2022 The Linux Foundation. All rights reserved. The Linux Foundation has
registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our
<a href=https://www.linuxfoundation.org/trademark-usage/>Trademark Usage</a> page.</p></div><script src=/js/slack-popup.js></script></div><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-110275540-2","auto"),ga("send","pageview")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-SFCPQYSLHY"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SFCPQYSLHY")</script><script type=text/javascript id=hs-script-loader async defer src=https://js.hs-scripts.com/5557732.js></script></body></html>