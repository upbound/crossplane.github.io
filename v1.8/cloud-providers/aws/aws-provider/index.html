<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Crossplane is a framework for building cloud native control planes without needing to write code. It has a highly extensible backend that enables you to build a control plane that can orchestrate applications and infrastructure no matter where they run, and a highly configurable frontend that puts you in control of the schema of the declarative API it offers."><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=robots content="noindex"><title>| Crossplane Documentation</title><meta name=twitter:card content="summary"><meta name=twitter:site content="https://crossplane.io"><meta name=twitter:title content="Crossplane"><meta name=twitter:description content="The cloud-native control plane framework"><meta name=twitter:image:src content="https://crossplane.io/images/twitter-card_400x400.jpg"><link rel=apple-touch-icon sizes=180x180 href="/favicons/apple-touch-icon.png?v=1.0"><link rel=icon type=image/png sizes=32x32 href="/favicons/favicon-32x32.png?v=1.0"><link rel=icon type=image/png sizes=16x16 href="/favicons/favicon-16x16.png?v=1.0"><link rel=manifest href="/favicons/site.webmanifest?v=1.0"><link rel=mask-icon href="/favicons/safari-pinned-tab.svg?v=1.0" color=#5bbad5><link rel="shortcut icon" href="/favicons/favicon.ico?v=1.0"><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css><link rel=stylesheet href=/css/docs.css><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js></script></head><body><div id=header><div><div class=logo><a href=/><img src=/images/logo.svg alt="Crossplane Logo"></a></div><div class=hamburger-controls onclick='return document.body.classList.contains("menu-open")?document.body.classList.remove("menu-open"):document.body.classList.add("menu-open"),!1'><span></span>
<span></span>
<span></span></div><ul class=links><li><a href=https://github.com/crossplane/crossplane><span class=md-hidden>Get Started on</span> GitHub</a></li><li><a href=/v1.9/>Documentation</a></li><li><a href=/community/>Community</a></li><li><a href=https://slack.crossplane.io/>Slack <span class=md-hidden>Channel</span></a></li><li><a href=https://blog.crossplane.io/>Blog</a></li><li><a href=https://twitter.com/crossplane_io>Twitter</a></li></ul></div></div><div id=docs-header><div><h1>Documentation</h1><div class=versions><div><div><select onchange="window.location.href=this.value"><option selected value=/master/cloud-providers/aws/aws-provider/>Crossplane master</option><option value=/v1.9/cloud-providers/aws/aws-provider/>Crossplane v1.9</option><option value=/v1.9/cloud-providers/azure/azure-provider/>Crossplane v1.9</option><option value=/v1.9/cloud-providers/gcp/gcp-provider/>Crossplane v1.9</option><option selected value=/v1.8/cloud-providers/aws/aws-provider/>Crossplane v1.8</option><option selected value=/v1.8/cloud-providers/azure/azure-provider/>Crossplane v1.8</option><option selected value=/v1.8/cloud-providers/gcp/gcp-provider/>Crossplane v1.8</option><option selected value=/v1.8/media/readme/>Crossplane v1.8</option><option value=/v1.7/cloud-providers/aws/aws-provider/>Crossplane v1.7</option><option value=/v1.7/cloud-providers/azure/azure-provider/>Crossplane v1.7</option><option value=/v1.7/cloud-providers/gcp/gcp-provider/>Crossplane v1.7</option><option value=/v1.7/media/readme/>Crossplane v1.7</option></select></div></div></div></div></div><div class=page><div class=docs-menu><ul id=docs-ul></ul></div><div class=docs-content><div class=docs-actions><a id=edit href=https://github.com/crossplane/crossplane/tree/release-1.8/docs/aws-provider.md><img src=/images/github-teal.svg>Edit on GitHub</a></div><div class="alert old"><p><b>PLEASE NOTE</b>: This document applies to version 1.8 and not to the latest release 1.9</p><strong>Documentation for other releases can be found by using the version selector in the top right of any doc page.</strong></div><h1></h1><h1 id=adding-amazon-web-services-aws-to-crossplane>Adding Amazon Web Services (AWS) to Crossplane</h1><p>In this guide, we will walk through the steps necessary to configure your AWS
account to be ready for integration with Crossplane. This will be done by adding
an AWS <code>ProviderConfig</code> resource type, which enables Crossplane to communicate with an
AWS account.</p><h2 id=requirements>Requirements</h2><p>Prior to adding AWS to Crossplane, following steps need to be taken</p><ul><li>Crossplane is installed in a k8s cluster</li><li><code>provider-aws</code> is installed in the same cluster</li><li><code>kubectl</code> is configured to communicate with the same cluster</li></ul><h2 id=step-1-configure-aws-cli>Step 1: Configure <code>aws</code> CLI</h2><p>Crossplane uses <a href=https://docs.aws.amazon.com/general/latest/gr/aws-security-credentials.html>AWS security credentials</a>, and stores them as a <a href=https://kubernetes.io/docs/concepts/configuration/secret/>secret</a> which
is managed by an AWS <code>ProviderConfig</code> instance. In addition, the AWS default region is
also used for targeting a specific region. Crossplane requires to have <a href=https://aws.amazon.com/cli/><code>aws</code>
command line tool</a> <a href=https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html>installed</a> and <a href=https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html>configured</a>. Once installed, the credentials
and configuration will reside in <code>~/.aws/credentials</code> and <code>~/.aws/config</code>
respectively.</p><h2 id=step-2-setup-aws-providerconfig>Step 2: Setup <code>aws</code> ProviderConfig</h2><p>Run <code>setup.sh</code> to read <code>aws</code> credentials and region, and create an <code>aws provider</code> instance in Crossplane:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -O https://raw.githubusercontent.com/crossplane/crossplane/release-1.8/docs/snippets/configure/aws/providerconfig.yaml
</span></span><span style=display:flex><span>curl -O https://raw.githubusercontent.com/crossplane/crossplane/release-1.8/docs/snippets/configure/aws/setup.sh
</span></span><span style=display:flex><span>chmod +x setup.sh
</span></span><span style=display:flex><span>./setup.sh <span style=color:#f92672>[</span>--profile aws_profile<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>The <code>--profile</code> switch is optional and specifies the <a href=https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html>aws named profile</a> that
was set in Step 1. If not provided, the <code>default</code> profile will be selected.</p><p>Once the script is successfully executed, Crossplane will use the specified aws
account and region in the given named profile to create subsequent AWS managed
resources.</p><p>You can confirm the existence of the AWS <code>ProviderConfig</code> by running:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get providerconfig default
</span></span></code></pre></div><h2 id=optional-setup-aws-provider-manually>Optional: Setup AWS Provider Manually</h2><p>An AWS <a href=https://docs.aws.amazon.com/mediapackage/latest/ug/setting-up-create-iam-user.html>user</a> with <code>Administrative</code> privileges is needed to enable
Crossplane to create the required resources. Once the user is provisioned, an
<a href=https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html>Access Key</a> needs to be created so the user can have API access.</p><p>Using the set of <a href=https://docs.aws.amazon.com/general/latest/gr/aws-security-credentials.html>access key credentials</a> for the user
with the right access, we need to <a href=https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html>install</a> <a href=https://aws.amazon.com/cli/><code>aws cli</code></a>, and then <a href=https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html>configure</a> it.</p><p>When the AWS cli is configured, the credentials and configuration will be in
<code>~/.aws/credentials</code> and <code>~/.aws/config</code> respectively. These will be consumed in
the next step.</p><p>When configuring the AWS cli, the user credentials could be configured under a
specific <a href=https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html>AWS named profile</a>, or under <code>default</code>. Without loss of generality,
in this guide let&rsquo;s assume that the credentials are configured under the
<code>aws_profile</code> profile (which could also be <code>default</code>). We&rsquo;ll use this profile to
setup cloud provider in the next section.</p><p>Crossplane uses the AWS user credentials that were configured in the previous
step to create resources in AWS. These credentials will be stored as a
<a href=https://kubernetes.io/docs/concepts/configuration/secret/>secret</a> in Kubernetes, and will be used by an AWS
<code>ProviderConfig</code> instance. The default AWS region is also pulled from the cli
configuration, and added to the AWS provider.</p><p>To store the credentials as a secret, run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># retrieve profile&#39;s credentials, save it under &#39;default&#39; profile, and base64 encode it</span>
</span></span><span style=display:flex><span>BASE64ENCODED_AWS_ACCOUNT_CREDS<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo -e <span style=color:#e6db74>&#34;[default]\naws_access_key_id = </span><span style=color:#66d9ef>$(</span>aws configure get aws_access_key_id --profile $aws_profile<span style=color:#66d9ef>)</span><span style=color:#e6db74>\naws_secret_access_key = </span><span style=color:#66d9ef>$(</span>aws configure get aws_secret_access_key --profile $aws_profile<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> | base64  | tr -d <span style=color:#e6db74>&#34;\n&#34;</span><span style=color:#66d9ef>)</span>
</span></span></code></pre></div><p>Next, we&rsquo;ll need to create an AWS provider configuration:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat &gt; provider.yaml <span style=color:#e6db74>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>---
</span></span></span><span style=display:flex><span><span style=color:#e6db74>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>kind: Secret
</span></span></span><span style=display:flex><span><span style=color:#e6db74>metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  name: aws-account-creds
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  namespace: crossplane-system
</span></span></span><span style=display:flex><span><span style=color:#e6db74>type: Opaque
</span></span></span><span style=display:flex><span><span style=color:#e6db74>data:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  creds: ${BASE64ENCODED_AWS_ACCOUNT_CREDS}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>---
</span></span></span><span style=display:flex><span><span style=color:#e6db74>apiVersion: aws.crossplane.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>kind: ProviderConfig
</span></span></span><span style=display:flex><span><span style=color:#e6db74>metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  name: default
</span></span></span><span style=display:flex><span><span style=color:#e6db74>spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  credentials:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    source: Secret
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    secretRef:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      namespace: crossplane-system
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      name: aws-account-creds
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      key: creds
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># apply it to the cluster:</span>
</span></span><span style=display:flex><span>kubectl apply -f <span style=color:#e6db74>&#34;provider.yaml&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># delete the credentials variable</span>
</span></span><span style=display:flex><span>unset BASE64ENCODED_AWS_ACCOUNT_CREDS
</span></span></code></pre></div><p>The output will look like the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>secret/aws-user-creds created
</span></span><span style=display:flex><span>provider.aws.crossplane.io/default created
</span></span></code></pre></div><p>Crossplane resources use the <code>ProviderConfig</code> named <code>default</code> if no specific
<code>ProviderConfig</code> is specified, so this <code>ProviderConfig</code> will be the default for
all AWS resources.</p></div></div><script>var i,j,menu=[],menuDom,item,itemDom,children;menu.push({childCurrent:!1,children:[{current:!1,name:"Install \u0026 Configure",url:"/v1.8/getting-started/install-configure/"},{current:!1,name:"Provision Infrastructure",url:"/v1.8/getting-started/provision-infrastructure/"},{current:!1,name:"Create a Configuration",url:"/v1.8/getting-started/create-configuration/"}],current:!1,name:"Overview",url:"/v1.8/getting-started/"}),menu.push({childCurrent:!1,children:[{current:!1,name:"Providers",url:"/v1.8/concepts/providers/"},{current:!1,name:"Managed Resources",url:"/v1.8/concepts/managed-resources/"},{current:!1,name:"Composite Resources",url:"/v1.8/concepts/composition/"},{current:!1,name:"Crossplane Packages",url:"/v1.8/concepts/packages/"},{current:!1,name:"Terminology",url:"/v1.8/concepts/terminology/"}],current:!1,name:"Concepts",url:"/v1.8/concepts/"}),menu.push({childCurrent:!1,children:[{current:!1,name:"Upgrading to v0.14",url:"/v1.8/guides/upgrading-to-v0.14/"},{current:!1,name:"Upgrading to v1.x",url:"/v1.8/guides/upgrading-to-v1.x/"},{current:!1,name:"Vault as an External Secret Store",url:"/v1.8/guides/vault-as-secret-store/"},{current:!1,name:"Vault Credential Injection",url:"/v1.8/guides/vault-injection/"},{current:!1,name:"Multi-Tenant Crossplane",url:"/v1.8/guides/multi-tenant/"},{current:!1,name:"Composition Revisions",url:"/v1.8/guides/composition-revisions/"},{current:!1,name:"Self-Signed CA Certs",url:"/v1.8/guides/self-signed-ca-certs/"}],current:!1,name:"Guides",url:"/v1.8/guides/"}),menu.push({childCurrent:!1,children:[{current:!1,name:"crossplane",url:"/v1.8/api-docs/crossplane/"},{current:!1,name:"provider-alibaba",url:"/v1.8/api-docs/provider-alibaba/"},{current:!1,name:"provider-aws",url:"/v1.8/api-docs/provider-aws/"},{current:!1,name:"provider-azure",url:"/v1.8/api-docs/provider-azure/"},{current:!1,name:"provider-gcp",url:"/v1.8/api-docs/provider-gcp/"},{current:!1,name:"provider-rook",url:"/v1.8/api-docs/provider-rook/"},{current:!1,name:"provider-helm",url:"/v1.8/api-docs/provider-helm/"}],current:!1,name:"API Documentation",url:"/v1.8/api-docs/"}),menu.push({childCurrent:!1,children:[{current:!1,name:"Provider Development Guide",url:"/v1.8/contributing/provider_development_guide/"},{current:!1,name:"Observability Developer Guide",url:"/v1.8/contributing/observability_developer_guide/"},{current:!1,name:"Release Process",url:"/v1.8/contributing/release-process/"},{current:!1,name:"Adding Secret Store Support",url:"/v1.8/contributing/adding_external_secret_store_support/"}],current:!1,name:"Contributing",url:"/v1.8/contributing/"}),menu.push({childCurrent:!1,children:[{current:!1,name:"Related Projects",url:"/v1.8/faqs/related_projects/"}],current:!1,name:"FAQ",url:"/v1.8/faqs/"});function getEntry(e){var t=document.createElement("li");return e.current?(t.innerHTML=e.name,t.classList.add("current")):t.innerHTML='<a href="'+e.url+'">'+e.name+"</a>",t}function flushCss(e){e.offsetHeight}function addArrow(e){var t=document.createElement("a");t.classList.add("arrow"),t.innerHTML="<div />",t.onclick=function(e){return function(){var n=59,s=16,t=n+s+e.lastChild.clientHeight+"px";return e.classList.toggle("open"),e.classList.contains("open")?e.style.height=t:(e.style.height==="auto"&&(e.style.transition="none",e.style.height=t,flushCss(e),e.style.transition=""),e.style.height="59px"),!1}}(e),e.appendChild(t),item.current&&item.children||item.childCurrent?(e.classList.add("open"),e.style.height="auto"):e.style.height="59px"}menuDom=document.getElementById("docs-ul");for(i=0;i<menu.length;i++){if(item=menu[i],itemDom=getEntry(item),item.childCurrent&&itemDom.classList.add("childCurrent"),item.children){addArrow(itemDom),itemDom.classList.add("children"),children=document.createElement("ul");for(j=0;j<item.children.length;j++)children.appendChild(getEntry(item.children[j]));itemDom.appendChild(children)}menuDom.appendChild(itemDom)}</script><script src=/js/anchor.js></script>
<script>anchors.options={placement:"right",icon:"#"},document.addEventListener("DOMContentLoaded",function(){anchors.add(".docs-content h1, .docs-content h2, .docs-content h3, .docs-content h4, .docs-content h5, .docs-content h6")})</script><div id=footer><div class=footer-main><div class=main><div class=logo><img src=/images/logo.svg alt="Crossplane Logo"></div></div><div class="links sm-hidden"><a href=https://twitter.com/crossplane_io>Twitter</a>
<a href=/v1.9/>Documentation</a>
<a href=https://github.com/crossplane/crossplane>GitHub</a>
<a href=https://slack.crossplane.io/>Slack Channel</a>
<a href=https://www.youtube.com/channel/UC19FgzMBMqBro361HbE46Fw>YouTube</a>
<a href=https://groups.google.com/forum/#!forum/crossplane-dev>Forum</a></div></div><div class=lf-copyright><p>&#169; Crossplane Authors 2022. Documentation distributed under
<a href=https://creativecommons.org/licenses/by/4.0/>CC-BY-4.0</a>.</p><p>&#169; 2022 The Linux Foundation. All rights reserved. The Linux Foundation has
registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our
<a href=https://www.linuxfoundation.org/trademark-usage/>Trademark Usage</a> page.</p></div><script src=/js/slack-popup.js></script></div><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-110275540-2","auto"),ga("send","pageview")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-SFCPQYSLHY"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SFCPQYSLHY")</script><script type=text/javascript id=hs-script-loader async defer src=https://js.hs-scripts.com/5557732.js></script></body></html>